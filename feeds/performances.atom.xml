<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Thomas Loiret - Random thoughts - performances</title><link href="https://b0uh.github.io/" rel="alternate"></link><link href="https://b0uh.github.io/feeds/performances.atom.xml" rel="self"></link><id>https://b0uh.github.io/</id><updated>2018-10-08T12:00:00-03:00</updated><entry><title>About looking for a bottleneck</title><link href="https://b0uh.github.io/about-looking-for-a-bottleneck.html" rel="alternate"></link><published>2018-10-08T12:00:00-03:00</published><updated>2018-10-08T12:00:00-03:00</updated><author><name>Thomas Loiret</name></author><id>tag:b0uh.github.io,2018-10-08:/about-looking-for-a-bottleneck.html</id><summary type="html">&lt;p&gt;Be sure to use trustworthy tools to determine your metrics and be methodical about how you are looking for a bottleneck.&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;TL;DR:&lt;/strong&gt; Be sure to use trustworthy tools to determine your metrics and be methodical about how you are looking for a bottleneck.&lt;/p&gt;
&lt;h1&gt;Introduction&lt;/h1&gt;
&lt;p&gt;Looking for a bottleneck often came after realizing that a system does not scale/behave as expected. This article try to describes some best practices to help find bottleneck and its cause!&lt;/p&gt;
&lt;h1&gt;System&lt;/h1&gt;
&lt;p&gt;The system is what your are trying to test and that may have a bottleneck. It can be a website, an application, a platform... anything.&lt;/p&gt;
&lt;p&gt;You should be able to &lt;strong&gt;describe the state of the system at any moment&lt;/strong&gt;. For example when we talk about a website as a system it's state description should includes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;source code (it can be a git commit)&lt;/li&gt;
&lt;li&gt;configuration&lt;/li&gt;
&lt;li&gt;infrastructure (e.g.: hardware, web server, ...)&lt;/li&gt;
&lt;li&gt;dependencies (e.g.: database, cache, ...)&lt;/li&gt;
&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Monitoring&lt;/h1&gt;
&lt;p&gt;When your system is set up &lt;strong&gt;you will need to be able to observe it and measure things in it&lt;/strong&gt;. If your system is in production you probably have some monitoring tool already setup for that, but that's not the only option. Some example of monitoring tools:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;general monitoring tools: Nagios/Zabbix/Datadog/...&lt;/li&gt;
&lt;li&gt;application logs : Logmatic/Loggly/... (could be even read directly from the log files)&lt;/li&gt;
&lt;li&gt;profiling tools: New Relic/Retrace/...&lt;/li&gt;
&lt;li&gt;cloud service monitoring tools. For example if you are using Atlas (mongodb provider) you can access a dashboard with some metrics.&lt;/li&gt;
&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Obviously you should choose a tool according to what you are trying to observe. During to research for the bottleneck &lt;strong&gt;you may need to change of tools&lt;/strong&gt; as you go further.&lt;/p&gt;
&lt;p&gt;Keep in mind that &lt;strong&gt;you should look at the big picture&lt;/strong&gt;. Do not focus on small variation, you want to be sure that if you observe a variation it worth it.&lt;/p&gt;
&lt;h1&gt;Stress operation&lt;/h1&gt;
&lt;p&gt;Now that you have your system and its monitoring up and running the next step it to stress it in order to find the flaw. This "stress operation" can be different things according to what you are testing:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a load test (sending a lot of requests to your website)&lt;/li&gt;
&lt;li&gt;a specific operation (register a new user for example)&lt;/li&gt;
&lt;li&gt;a new dependency (if you want to change of DB for example)&lt;/li&gt;
&lt;li&gt;...&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Trust&lt;/h1&gt;
&lt;p&gt;Not much to say here except that &lt;strong&gt;you should trust your system setup and monitoring tool&lt;/strong&gt;. If not, no need to go further, you will not be able to work properly and find the bottleneck!&lt;/p&gt;
&lt;p&gt;Some questions you should ask yourself:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Does the system is set up properly?&lt;/li&gt;
&lt;li&gt;In what condition/configuration my system is?&lt;/li&gt;
&lt;li&gt;What stress operation am I doing excatly?&lt;/li&gt;
&lt;li&gt;Does the monitoring tool can be trustworthy? (Compare data with another tool to cross check)&lt;/li&gt;
&lt;li&gt;Does it have all the data? an average? or just some data from time to time?&lt;/li&gt;
&lt;/ul&gt;
&lt;h1&gt;Methodology&lt;/h1&gt;
&lt;p&gt;Finding the bottleneck is about tweaking your system parameters one by one.
The bottleneck is probably something not intuitive/obvious. You need to keep a trace of all the tests your are doing.
Basically you have to be methodological about what your are doing.&lt;/p&gt;
&lt;p&gt;Here is a template of a document that can help to be methodological when looking for a bottleneck.&lt;/p&gt;
&lt;h2&gt;Template&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;# Initial conditions

## System condition
- ...

## Stress operation condition
- ...


# Initial stress operation

## Stress operation 1

### Conditions
- ...

### Observations
- ...

## Stress operation 2

### Conditions
- ...

### Observations
- ...


# Problem
- Describe the problem found in the initial stress operation. Explain what are you expecting


# Hypothesis: ....

## Stress operation conditions
- ...

## Observations
- ...

## Conclusions
- ...
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Repeat the "Hypothesis" section until the conclusion reaches your expectation describe in the "Problem" section.&lt;/p&gt;
&lt;p&gt;Good luck for your research!&lt;/p&gt;</content><category term="bottleneck"></category><category term="load test"></category><category term="loadtest"></category><category term="monitoring"></category><category term="find"></category><category term="bottlenecks"></category><category term="trust"></category></entry></feed>