<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Thomas Loiret">
  <meta name="description" content="Be sure to use trustworthy tools to determine your metrics and be methodical about how you are looking for a bottleneck.">

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@b0uh" />
    <meta name="twitter:title" content="About looking for a bottleneck - Thomas Loiret - Random thoughts" />
    <meta name="twitter:description" content="Be sure to use trustworthy tools to determine your metrics and be methodical about how you are looking for a bottleneck." />

  <meta name="google-site-verification" content="jZBc2U9MHiBnSlgpoFEed-V3PZ16pMNv0GSX4hOh4mg" />

  <title>About looking for a bottleneck - Thomas Loiret - Random thoughts</title>

  <!-- Custom styles for this template -->
  <!-- build:css stylesheets/main.css -->
  <link rel="stylesheet" href="https://b0uh.github.io/theme/css/main.css">
  <link rel="stylesheet" href="https://b0uh.github.io/theme/css/custom.css">
  <link rel="stylesheet" href="https://b0uh.github.io/theme/css/pygments/autumn.css">
  <!-- endbuild -->

  <link href="https://b0uh.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Thomas Loiret - Random thoughts Atom Feed" />

  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
  <![endif]-->

  <!-- Google Fonts -->
  <script type="text/javascript">
  WebFontConfig = {
    google: { families: [ 'Open+Sans:300,400,700:latin', 'Lato:700,900:latin' ] }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
  </script>
</head>

<body>
<!-- header -->
<header class="header  push-down-45">
  <div class="container">

    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#readable-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>

    <nav class="navbar  navbar-default" role="navigation">
      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse  navbar-collapse" id="readable-navbar-collapse">
        <ul class="navigation">

          <li>
            <a href="https://b0uh.github.io">Home</a>
          </li>

            <li>
              <a href="https://b0uh.github.io/pages/about.html">About</a>
            </li>

        </ul>
      </div><!-- /.navbar-collapse -->
    </nav>

    <div class="hidden-xs  hidden-sm">
      <div class="social">
        <a href="#" class="search__container">
          <span class="glyphicon  glyphicon-flash"></span>
        </a>
        <ul class="social__dropdown">
            <li>
              <a href="https://b0uh.github.io/feeds/all.atom.xml" target="_blank" class="social__container">
                <span class="zocial-rss"></span>
              </a>
            </li>
          <li>
            <a href="https://twitter.com/b0uh" target="_blank" class="social__container">
              <span class="zocial-twitter"></span>
            </a>
          </li>
          <li>
            <a href="https://www.linkedin.com/in/thomasloiret/" target="_blank" class="social__container">
              <span class="zocial-linkedin"></span>
            </a>
          </li>
          <!-- <li>
            <a href="https://www.malt.fr/profile/thomasloiret" target="_blank" class="social__container">
              <img src="https://b0uh.github.io/theme/images/icons/malt-25px.png" />
            </a>
          </li> -->
          <li>
            <a href="https://www.last.fm/user/b0uh" target="_blank" class="social__container">
              <span class="zocial-lastfm"></span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</header>

<div class="container">

      <div itemscope itemtype="http://schema.org/Article" class="boxed push-down-60">


        <!-- Start of the blogpost -->
        <div class="row">
          <div class="col-xs-10  col-xs-offset-1  col-md-8  col-md-offset-2  push-down-60">

            <!-- Start of the content -->
            <div class="post-content">

              <h1 itemprop="name">About looking for a bottleneck</h1>

              <div class="meta__container--without-image">
                <div class="row">
                  <div class="col-xs-12  col-sm-8">
                    <span itemprop="author" itemscope itemtype="http://schema.org/Person">
                      <div class="meta__info" itemprop="name">
                        Thomas Loiret
                      </div>
                    </span>
                  </div>
                  <div class="col-xs-12  col-sm-4">
                    <div class="meta__comments">
                      <span class="meta__date" itemprop="datePublished" content="2018-10-08">
                        <span class="glyphicon glyphicon-calendar"></span>  &nbsp; Mon 08 October 2018
                      </span>
                    </div>
                  </div>
                </div>
              </div>

              <span itemprop="articleBody">
                <p><strong>TL;DR:</strong> Be sure to use trustworthy tools to determine your metrics and be methodical about how you are looking for a bottleneck.</p>
<h1>Introduction</h1>
<p>Looking for a bottleneck often came after realizing that a system does not scale/behave as expected. This article tries to describe some best practices to help find bottleneck and its cause!</p>
<h1>System</h1>
<p>The system is what you are trying to test and that may have a bottleneck. It can be a website, an application, a platform... anything.</p>
<p>You should be able to <strong>describe the state of the system at any moment</strong>. For example when we talk about a website as a system its state description should include:</p>
<ul>
<li>source code (it can be a git commit)</li>
<li>configuration</li>
<li>infrastructure (e.g.: hardware, web server, ...)</li>
<li>dependencies (e.g.: database, cache, ...)</li>
<li>...</li>
</ul>
<h1>Monitoring</h1>
<p>When your system is set up <strong>you will need to be able to observe it and measure things in it</strong>. If your system is in production you probably have some monitoring tools already set up for that, but that's not the only option. Some examples of monitoring tools:</p>
<ul>
<li>general monitoring tools: Nagios/Zabbix/Datadog/...</li>
<li>application logs : Logmatic/Loggly/... (could be even read directly from the log files)</li>
<li>profiling tools: New Relic/Retrace/...</li>
<li>cloud service monitoring tools. For example if you are using Atlas (mongodb provider) you can access a dashboard with some metrics.</li>
<li>...</li>
</ul>
<p>Obviously you should choose a tool according to what you are trying to observe. During the search of the bottleneck <strong>you may need to change tools</strong> as you go further.</p>
<p>Keep in mind that <strong>you should look at the big picture</strong>. Do not focus on small variations, you want to be sure that if you observe a variation it is worth it.</p>
<h1>Stress operation</h1>
<p>Now that you have your system and its monitoring up and running the next step it to stress it in order to find the flaw. This "stress operation" can be different things according to what you are testing:</p>
<ul>
<li>a load test (sending a lot of requests to your website)</li>
<li>a specific operation (register a new user for example)</li>
<li>a new dependency (if you want to change of DB for example)</li>
<li>...</li>
</ul>
<h1>Trust</h1>
<p>Not much to say here except that <strong>you should trust your system setup and monitoring tool</strong>. If not, no need to go further, you will not be able to work properly and find the bottleneck!</p>
<p>Some questions you should ask yourself:</p>
<ul>
<li>Is the system set up properly?</li>
<li>In which condition/configuration my system is in?</li>
<li>Which stress operation am I doing exactly?</li>
<li>Is the monitoring tool trustworthy? (Compare data with another tool to cross check)</li>
<li>Does it have all the data? an average? or just some data from time to time?</li>
</ul>
<h1>Methodology</h1>
<p>Finding the bottleneck is about tweaking your system parameters one by one.
The bottleneck is probably something not intuitive/obvious. You need to keep a trace of all the tests you are doing.
Basically you have to be methodological about what you are doing.</p>
<p>Here is a template of a document that can help to be methodological when looking for a bottleneck.</p>
<h2>Template</h2>
<div class="highlight"><pre><span></span># Initial conditions

## System condition
- ...

## Stress operation condition
- ...


# Initial stress operation

## Stress operation 1

### Conditions
- ...

### Observations
- ...

## Stress operation 2

### Conditions
- ...

### Observations
- ...


# Problem
- Describe the problem found in the initial stress operation. Explain what are you expecting


# Hypothesis: ....

## Stress operation conditions
- ...

## Observations
- ...

## Conclusions
- ...
</pre></div>


<p>Repeat the "Hypothesis" section until the conclusion reaches the expectation described in the "Problem" section.</p>
<p>Good luck for your search!</p>
              </span>

              <div class="meta__container--without-image">
                <div class="row">
                </div>
              </div>

              <br>

              <p>
                <!-- AddToAny BEGIN -->
                <div class="a2a_kit a2a_kit_size_32 a2a_default_style">
                <a class="a2a_button_twitter"></a>
                <a class="a2a_button_linkedin"></a>
                <a class="a2a_button_facebook"></a>
                <a class="a2a_button_reddit"></a>
                </div>
                <script async src="https://static.addtoany.com/menu/page.js"></script>
                <!-- AddToAny END -->
              </p>

            </div>
          </div>
        </div>
      </div>

</div>

<footer class="copyrights">
  <div class="container">
    <div class="row">
      <div class="col-xs-12  col-sm-6">
        Powered by <a href="https://github.com/getpelican/pelican">Pelican</a>.
      </div>
      <div class="col-xs-12  col-sm-6">
        <div class="copyrights--right">
          Made with <span class="glyphicon  glyphicon-heart"></span> in Nantes.
        </div>
      </div>
    </div>
  </div>
</footer>

  <script src="https://b0uh.github.io/theme/scripts/jquery.min.js"></script>
  <script src="https://b0uh.github.io/theme/scripts/underscore.js"></script>
  <script src="https://b0uh.github.io/theme/scripts/bootstrap.min.js"></script>
  <script src="https://b0uh.github.io/theme/scripts/main.js"></script>


  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-98369697-1', 'auto');
    ga('send', 'pageview');

  </script>

</body>
</html>